# Tunnox Server 测试配置
server:
  host: "0.0.0.0"
  port: 7000
  read_timeout: 30
  write_timeout: 30
  idle_timeout: 60
  
  protocols:
    tcp:
      enabled: true
      port: 7001
      host: "0.0.0.0"
    websocket:
      enabled: true
      port: 7000
      host: "0.0.0.0"
    udp:
      enabled: false
      port: 7002
      host: "0.0.0.0"
    quic:
      enabled: true
      port: 7003
      host: "0.0.0.0"

# 存储配置
storage:
  # 存储类型: memory | redis | hybrid
  type: hybrid
  
  # Redis 存储配置（当 type=redis 或 hybrid.cache_type=redis 时使用）
  redis:
    addr: "localhost:6379"
    password: ""
    db: 0
    pool_size: 10
  
  # 混合存储配置（当 type=hybrid 时使用）
  hybrid:
    # 缓存类型: memory | redis
    cache_type: memory
    
    # 是否启用持久化
    enable_persistent: false
    
    # 持久化前缀（用于自动区分数据类别）
    persistent_prefixes:
      - "tunnox:user:"
      - "tunnox:client:"
      - "tunnox:mapping:"
      - "tunnox:quota:"
    
    # 运行时前缀（用于自动区分数据类别）
    runtime_prefixes:
      - "tunnox:runtime:"
      - "tunnox:session:"
      - "tunnox:connection:"
      - "tunnox:id:used:"
    
    # 默认 TTL（秒）
    default_persistent_ttl: 0      # 0 表示永久
    default_runtime_ttl: 86400     # 24 小时
    
    # 远程持久化存储配置（enable_persistent=true 时使用）
    remote:
      # 远程存储类型: grpc | http
      type: grpc
      
      # gRPC 配置
      grpc:
        address: "storage-service:50051"
        timeout: 5  # 秒
        max_retries: 3
        tls:
          enabled: false
          cert_file: ""
          key_file: ""
          ca_file: ""

log:
  level: "debug"
  format: "text"
  output: "stdout"

cloud:
  type: "built_in"
  built_in:
    jwt_secret_key: "test-secret-key-for-testing-only"
    jwt_expiration: 3600
    refresh_expiration: 604800
    jwt_issuer: "tunnox-test"
    cleanup_interval: 300
    data_ttl: 86400
    id_length: 16
    max_attempts: 10

# MessageBroker 配置（单节点使用 memory）
message_broker:
  type: "memory"
  node_id: "test-node-001"

# Bridge 连接池配置（单节点测试禁用）
bridge_pool:
  enabled: false

performance:
  buffer_pool:
    initial_size: 100
    max_size: 1000
    buffer_size: 4096
  connection_pool:
    max_connections: 100
    idle_timeout: 300
    max_lifetime: 3600

monitoring:
  metrics:
    enabled: false
  health_check:
    enabled: false

security:
  tls:
    enabled: false

development:
  debug: true

# Management API 配置
management_api:
  enabled: true
  listen_addr: ":9000"
  auth:
    type: "api_key"
    secret: "test-api-key-for-management-api-1234567890"
  cors:
    enabled: true
    allowed_origins: ["*"]
  rate_limit:
    enabled: false

udp_ingress:
  enabled: false
  listeners: []

